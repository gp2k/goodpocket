# 클러스터 복잡도 진단

사용자 피드백: "클러스터가 너무 복잡해서 의미가 없는 것 같다"

---

## 1. 증상 요약

- **시각적 압도**: 노드와 연결선이 매우 조밀하게 배치되어 한눈에 파악하기 어렵다.
- **중앙 집중**: 모든 연결이 중앙(내 북마크) 한 점에서 방사형으로 퍼져 나간다.
- **가독성 저하**: 노드가 작고 겹쳐 있어 개별 라벨·내용을 읽기 어렵다.
- **의미 부족**: 그룹이 너무 많고 잘게 쪼개져 있어 "비슷한 북마크 그룹"이라는 목적을 달성했다고 느끼기 어렵다.

---

## 2. 원인 진단

### 2-1. 클러스터 수에 제한이 없음 (가장 직접적 원인)

- **백엔드** (`/api/clusters`): 사용자의 **모든** `dup_groups`를 반환한다. **LIMIT 없음**.
- **프론트**: 받은 클러스터를 **전부** 마인드맵에 노드로 그린다.
- 따라서 dup_groups가 50개, 100개, 200개면 그만큼 노드와 “중앙→클러스터” 선이 생긴다.
- 결과: 중앙에서 수십~수백 개의 선이 뻗어 나가는 **단일 레벨의 거대한 star 그래프**가 됨.

### 2-2. 그룹 단위가 “거의 중복” 수준이라 개수가 많아짐

- 현재 클러스터 = **dup_groups** = simhash로 묶인 **거의 같은 문서** 단위.
- Simhash 해밍 거리 ≤3으로 묶기 때문에:
  - 진짜 중복/유사 문서는 잘 묶이지만,
  - 서로 다른 주제의 북마크는 각각 작은 그룹(2~3개)으로 많이 생길 수 있다.
- 즉, **의미 단위(주제/도메인)**가 아니라 **유사도 버킷** 단위라서, 사용자가 기대하는 “몇 개의 큰 주제”가 아니라 “많은 작은 그룹”이 나오기 쉬움.

### 2-3. 상위 구조(topics)를 쓰지 않음

- DB에는 **topics**(계층)와 **dup_group_topics**(dup_group ↔ topic 연결)가 있음.
- 하지만 **클러스터 API와 UI는 topics를 전혀 사용하지 않고**, 오직 dup_groups만 노출함.
- 따라서:
  - “도메인/주제별로 묶어서 보기” 같은 **상위 레벨 뷰**가 없고,
  - 항상 **가장 세분화된 레벨(dup_groups)**만 보이게 됨 → 노드 수가 많고 구조가 단조로움.

### 2-4. 마인드맵 구조가 단일 레벨

- 구조: **root(중앙) → 클러스터₁, 클러스터₂, … , 클러스터ₙ**
- 클러스터 간 연결이나, “주제 → 하위 클러스터” 같은 **계층/그룹핑**이 없음.
- 클러스터 수가 많을수록:
  - 중앙 주변에 노드가 빽빽해지고,
  - 모든 링크가 root에만 연결되어 시각적으로 단순한 star일 뿐, 탐색/이해에 도움이 되기 어렵다.

### 2-5. 기본 줌/캔버스

- 기본 줌이 작으면(예: 30%) 전체가 한 화면에 압축되어, 노드/선이 더 작고 겹쳐 보임.
- 노드 수가 많은 상황에서는 이 효과가 더 커져 “복잡하다”는 인상이 강해짐.

---

## 3. 원인 요약표

| 관점 | 원인 |
|------|------|
| **데이터 양** | API가 dup_groups **전부** 반환, 상한 없음 → 노드/선 개수 과다 |
| **그룹 의미** | dup_groups = “거의 같은 문서” 단위 → 그룹이 많고 작음, 주제 단위가 아님 |
| **구조** | topics/dup_group_topics 미사용 → 상위 주제로 묶은 뷰 없음 |
| **시각화** | root → N개 클러스터만 있는 단일 레벨 → star 그래프, 계층/그룹핑 없음 |
| **UX** | 클러스터 수가 많을 때 기본 줌/캔버스로는 가독성 한계 |

---

## 4. 개선 방향 (참고)

- **API**: 클러스터 목록에 `limit`(예: 상위 20~30개) 또는 `min_size`(예: 4개 이상만) 적용해 노출 개수 제한.
- **데이터 모델**: topics를 활용해 “주제/도메인 → 그 아래 dup_groups” 계층 API를 만들고, 마인드맵을 **2단계(주제 → 클러스터)**로 표시.
- **UI**: 마인드맵에서 “상위 N개만 표시”, “작은 클러스터 접기/숨기기”, 기본 줌/초기 레이아웃 조정 등으로 복잡도 완화.
- **알고리즘**: (선택) simhash 임계값·그룹 병합 정책 재검토해, 의미 있는 크기의 그룹 수가 나오도록 조정.

이 문서는 **증상과 원인 진단**만 다루며, 실제 수정은 별도 작업으로 진행하면 됩니다.
